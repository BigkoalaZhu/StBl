// Color map based on work by Kenneth Moreland: http://www.sandia.gov/~kmorel/documents/ColorMaps/

#pragma once

#include <QColor>
#include <QVector>

inline QVector<QColor> rndColors2(int count){
	QVector<QColor> colors;
	float currentHue = 0.0;
	for (int i = 0; i < count; i++){
		colors.push_back( QColor::fromHslF(currentHue, 1.0, 0.5) );
		currentHue += 0.618033988749895f;
		currentHue = std::fmod(currentHue, 1.0f);
	}
	return colors;
}

inline QVector< QColor > makeColorMap()
{
	QVector<int> colorArray;
	colorArray <<59<<76<<192<<60<<78<<194<<61<<80<<195<<62<<81<<197<<
		63<<83<<198<<64<<85<<200<<66<<87<<201<<67<<88<<203<<68<<90<<204<<
		69<<92<<206<<70<<93<<207<<71<<95<<209<<73<<97<<210<<74<<99<<211<<
		75<<100<<213<<76<<102<<214<<77<<104<<215<<79<<105<<217<<
		80<<107<<218<<81<<109<<219<<82<<110<<221<<84<<112<<222<<
		85<<114<<223<<86<<115<<224<<87<<117<<225<<89<<119<<226<<
		90<<120<<228<<91<<122<<229<<93<<123<<230<<94<<125<<231<<
		95<<127<<232<<96<<128<<233<<98<<130<<234<<99<<131<<235<<
		100<<133<<236<<102<<135<<237<<103<<136<<238<<104<<138<<239<<
		106<<139<<239<<107<<141<<240<<108<<142<<241<<110<<144<<242<<
		111<<145<<243<<112<<147<<243<<114<<148<<244<<115<<150<<245<<
		116<<151<<246<<118<<153<<246<<119<<154<<247<<120<<156<<247<<
		122<<157<<248<<123<<158<<249<<124<<160<<249<<126<<161<<250<<
		127<<163<<250<<129<<164<<251<<130<<165<<251<<131<<167<<252<<
		133<<168<<252<<134<<169<<252<<135<<171<<253<<137<<172<<253<<
		138<<173<<253<<140<<174<<254<<141<<176<<254<<142<<177<<254<<
		144<<178<<254<<145<<179<<254<<147<<181<<255<<148<<182<<255<<
		149<<183<<255<<151<<184<<255<<152<<185<<255<<153<<186<<255<<
		155<<187<<255<<156<<188<<255<<158<<190<<255<<159<<191<<255<<
		160<<192<<255<<162<<193<<255<<163<<194<<255<<164<<195<<254<<
		166<<196<<254<<167<<197<<254<<168<<198<<254<<170<<199<<253<<
		171<<199<<253<<172<<200<<253<<174<<201<<253<<175<<202<<252<<
		176<<203<<252<<178<<204<<251<<179<<205<<251<<180<<205<<251<<
		182<<206<<250<<183<<207<<250<<184<<208<<249<<185<<208<<248<<
		187<<209<<248<<188<<210<<247<<189<<210<<247<<190<<211<<246<<
		192<<212<<245<<193<<212<<245<<194<<213<<244<<195<<213<<243<<
		197<<214<<243<<198<<214<<242<<199<<215<<241<<200<<215<<240<<
		201<<216<<239<<203<<216<<238<<204<<217<<238<<205<<217<<237<<
		206<<217<<236<<207<<218<<235<<208<<218<<234<<209<<219<<233<<
		210<<219<<232<<211<<219<<231<<213<<219<<230<<214<<220<<229<<
		215<<220<<228<<216<<220<<227<<217<<220<<225<<218<<220<<224<<
		219<<220<<223<<220<<221<<222<<221<<221<<221<<222<<220<<219<<
		223<<220<<218<<224<<219<<216<<225<<219<<215<<226<<218<<214<<
		227<<218<<212<<228<<217<<211<<229<<216<<209<<230<<216<<208<<
		231<<215<<206<<232<<215<<205<<232<<214<<203<<233<<213<<202<<
		234<<212<<200<<235<<212<<199<<236<<211<<197<<236<<210<<196<<
		237<<209<<194<<238<<209<<193<<238<<208<<191<<239<<207<<190<<
		240<<206<<188<<240<<205<<187<<241<<204<<185<<241<<203<<184<<
		242<<202<<182<<242<<201<<181<<243<<200<<179<<243<<199<<178<<
		244<<198<<176<<244<<197<<174<<245<<196<<173<<245<<195<<171<<
		245<<194<<170<<245<<193<<168<<246<<192<<167<<246<<191<<165<<
		246<<190<<163<<246<<188<<162<<247<<187<<160<<247<<186<<159<<
		247<<185<<157<<247<<184<<156<<247<<182<<154<<247<<181<<152<<
		247<<180<<151<<247<<178<<149<<247<<177<<148<<247<<176<<146<<
		247<<174<<145<<247<<173<<143<<247<<172<<141<<247<<170<<140<<
		247<<169<<138<<247<<167<<137<<247<<166<<135<<246<<164<<134<<
		246<<163<<132<<246<<161<<131<<246<<160<<129<<245<<158<<127<<
		245<<157<<126<<245<<155<<124<<244<<154<<123<<244<<152<<121<<
		244<<151<<120<<243<<149<<118<<243<<147<<117<<242<<146<<115<<
		242<<144<<114<<241<<142<<112<<241<<141<<111<<240<<139<<109<<
		240<<137<<108<<239<<136<<106<<238<<134<<105<<238<<132<<103<<
		237<<130<<102<<236<<129<<100<<236<<127<<99<<235<<125<<97<<
		234<<123<<96<<233<<121<<95<<233<<120<<93<<232<<118<<92<<
		231<<116<<90<<230<<114<<89<<229<<112<<88<<228<<110<<86<<
		227<<108<<85<<227<<106<<83<<226<<104<<82<<225<<102<<81<<
		224<<100<<79<<223<<98<<78<<222<<96<<77<<221<<94<<75<<220<<92<<74<<
		218<<90<<73<<217<<88<<71<<216<<86<<70<<215<<84<<69<<214<<82<<67<<
		213<<80<<66<<212<<78<<65<<210<<75<<64<<209<<73<<62<<208<<71<<61<<
		207<<69<<60<<205<<66<<59<<204<<64<<57<<203<<62<<56<<202<<59<<55<<
		200<<57<<54<<199<<54<<53<<198<<51<<52<<196<<49<<50<<195<<46<<49<<
		193<<43<<48<<192<<40<<47<<190<<37<<46<<189<<34<<45<<188<<30<<44<<
		186<<26<<43<<185<<22<<41<<183<<17<<40<<181<<11<<39<<180<<4<<38; 

	QVector< QColor > result;
	for(int i = 0; i < colorArray.size();){
		QColor color(colorArray[i], colorArray[i+1], colorArray[i+2]);
		i += 3;
		result.push_back(color);
	}
	return result;
}


inline QVector< QColor > makeColorMapJet()
{
	QVector<double> colorArray;
	colorArray << 0.672506 << 0.000000 << 0.000000 <<
		0.684183 << 0.000000 << 0.000000 <<
		0.695861 << 0.000000 << 0.000000 <<
		0.707539 << 0.000000 << 0.000000 <<
		0.719217 << 0.000000 << 0.000000 <<
		0.730895 << 0.000000 << 0.000000 <<
		0.742573 << 0.000000 << 0.000000 <<
		0.754251 << 0.000000 << 0.000000 <<
		0.765929 << 0.000000 << 0.000000 <<
		0.777607 << 0.000000 << 0.000000 <<
		0.789284 << 0.000000 << 0.000000 <<
		0.800962 << 0.000000 << 0.000000 <<
		0.812640 << 0.000000 << 0.000000 <<
		0.824318 << 0.000000 << 0.000000 <<
		0.835996 << 0.000000 << 0.000000 <<
		0.847674 << 0.000000 << 0.000000 <<
		0.859352 << 0.000000 << 0.000000 <<
		0.871030 << 0.000000 << 0.000000 <<
		0.882707 << 0.000000 << 0.000000 <<
		0.894385 << 0.000000 << 0.000000 <<
		0.906063 << 0.000000 << 0.000000 <<
		0.917741 << 0.000000 << 0.000000 <<
		0.929419 << 0.000000 << 0.000000 <<
		0.941097 << 0.000000 << 0.000000 <<
		0.952775 << 0.000000 << 0.000000 <<
		0.964453 << 0.000000 << 0.000000 <<
		0.976130 << 0.000000 << 0.000000 <<
		0.987808 << 0.000000 << 0.000000 <<
		0.999486 << 0.000000 << 0.000000 <<
		1.000000 << 0.011214 << 0.000000 <<
		1.000000 << 0.022945 << 0.000000 <<
		1.000000 << 0.034675 << 0.000000 <<
		1.000000 << 0.046406 << 0.000000 <<
		1.000000 << 0.058136 << 0.000000 <<
		1.000000 << 0.069867 << 0.000000 <<
		1.000000 << 0.081597 << 0.000000 <<
		1.000000 << 0.093328 << 0.000000 <<
		1.000000 << 0.105058 << 0.000000 <<
		1.000000 << 0.116789 << 0.000000 <<
		1.000000 << 0.128519 << 0.000000 <<
		1.000000 << 0.140250 << 0.000000 <<
		1.000000 << 0.151980 << 0.000000 <<
		1.000000 << 0.163711 << 0.000000 <<
		1.000000 << 0.175441 << 0.000000 <<
		1.000000 << 0.187172 << 0.000000 <<
		1.000000 << 0.198902 << 0.000000 <<
		1.000000 << 0.210633 << 0.000000 <<
		1.000000 << 0.222363 << 0.000000 <<
		1.000000 << 0.234093 << 0.000000 <<
		1.000000 << 0.245824 << 0.000000 <<
		1.000000 << 0.257554 << 0.000000 <<
		1.000000 << 0.269285 << 0.000000 <<
		1.000000 << 0.281015 << 0.000000 <<
		1.000000 << 0.292746 << 0.000000 <<
		1.000000 << 0.304476 << 0.000000 <<
		1.000000 << 0.316207 << 0.000000 <<
		1.000000 << 0.327937 << 0.000000 <<
		1.000000 << 0.339668 << 0.000000 <<
		1.000000 << 0.351398 << 0.000000 <<
		1.000000 << 0.363129 << 0.000000 <<
		1.000000 << 0.374859 << 0.000000 <<
		1.000000 << 0.386590 << 0.000000 <<
		1.000000 << 0.398320 << 0.000000 <<
		1.000000 << 0.410051 << 0.000000 <<
		1.000000 << 0.421781 << 0.000000 <<
		1.000000 << 0.433512 << 0.000000 <<
		1.000000 << 0.445242 << 0.000000 <<
		1.000000 << 0.456973 << 0.000000 <<
		1.000000 << 0.468703 << 0.000000 <<
		1.000000 << 0.480434 << 0.000000 <<
		1.000000 << 0.492164 << 0.000000 <<
		1.000000 << 0.503895 << 0.000000 <<
		1.000000 << 0.515625 << 0.000000 <<
		1.000000 << 0.527355 << 0.000000 <<
		1.000000 << 0.539086 << 0.000000 <<
		1.000000 << 0.550816 << 0.000000 <<
		1.000000 << 0.562547 << 0.000000 <<
		1.000000 << 0.574277 << 0.000000 <<
		1.000000 << 0.586008 << 0.000000 <<
		1.000000 << 0.597738 << 0.000000 <<
		1.000000 << 0.609469 << 0.000000 <<
		1.000000 << 0.621199 << 0.000000 <<
		1.000000 << 0.632930 << 0.000000 <<
		1.000000 << 0.644660 << 0.000000 <<
		1.000000 << 0.656391 << 0.000000 <<
		1.000000 << 0.668121 << 0.000000 <<
		1.000000 << 0.679852 << 0.000000 <<
		1.000000 << 0.691582 << 0.000000 <<
		1.000000 << 0.703313 << 0.000000 <<
		1.000000 << 0.715043 << 0.000000 <<
		1.000000 << 0.726774 << 0.000000 <<
		1.000000 << 0.738504 << 0.000000 <<
		1.000000 << 0.750235 << 0.000000 <<
		1.000000 << 0.761965 << 0.000000 <<
		1.000000 << 0.773696 << 0.000000 <<
		1.000000 << 0.785426 << 0.000000 <<
		1.000000 << 0.797157 << 0.000000 <<
		1.000000 << 0.808887 << 0.000000 <<
		1.000000 << 0.820617 << 0.000000 <<
		1.000000 << 0.832348 << 0.000000 <<
		1.000000 << 0.844078 << 0.000000 <<
		1.000000 << 0.855809 << 0.000000 <<
		1.000000 << 0.867539 << 0.000000 <<
		1.000000 << 0.879270 << 0.000000 <<
		1.000000 << 0.891000 << 0.000000 <<
		1.000000 << 0.902731 << 0.000000 <<
		1.000000 << 0.914461 << 0.000000 <<
		1.000000 << 0.926192 << 0.000000 <<
		1.000000 << 0.937922 << 0.000000 <<
		1.000000 << 0.949653 << 0.000000 <<
		1.000000 << 0.961383 << 0.000000 <<
		1.000000 << 0.973114 << 0.000000 <<
		1.000000 << 0.984844 << 0.000000 <<
		1.000000 << 0.996575 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		1.000000 << 1.000000 << 0.000000 <<
		0.993351 << 1.000000 << 0.001209 <<
		0.970580 << 1.000000 << 0.005349 <<
		0.947809 << 1.000000 << 0.009489 <<
		0.925038 << 1.000000 << 0.013629 <<
		0.902267 << 1.000000 << 0.017770 <<
		0.879496 << 1.000000 << 0.021910 <<
		0.856725 << 1.000000 << 0.026050 <<
		0.833954 << 1.000000 << 0.030190 <<
		0.811183 << 1.000000 << 0.034330 <<
		0.788412 << 1.000000 << 0.038470 <<
		0.765642 << 1.000000 << 0.042611 <<
		0.742871 << 1.000000 << 0.046751 <<
		0.720100 << 1.000000 << 0.050891 <<
		0.697329 << 1.000000 << 0.055031 <<
		0.674558 << 1.000000 << 0.059171 <<
		0.651787 << 1.000000 << 0.063311 <<
		0.629016 << 1.000000 << 0.067452 <<
		0.606245 << 1.000000 << 0.071592 <<
		0.583474 << 1.000000 << 0.075732 <<
		0.560703 << 1.000000 << 0.079872 <<
		0.537932 << 1.000000 << 0.084012 <<
		0.515161 << 1.000000 << 0.088152 <<
		0.492390 << 1.000000 << 0.092293 <<
		0.469619 << 1.000000 << 0.096433 <<
		0.446849 << 1.000000 << 0.100573 <<
		0.424078 << 1.000000 << 0.104713 <<
		0.401307 << 1.000000 << 0.108853 <<
		0.378536 << 1.000000 << 0.112994 <<
		0.355765 << 1.000000 << 0.117134 <<
		0.342061 << 0.998187 << 0.127318 <<
		0.329640 << 0.996117 << 0.138359 <<
		0.317220 << 0.994046 << 0.149399 <<
		0.304799 << 0.991976 << 0.160440 <<
		0.292379 << 0.989906 << 0.171480 <<
		0.279958 << 0.987836 << 0.182521 <<
		0.267538 << 0.985766 << 0.193561 <<
		0.255117 << 0.983696 << 0.204602 <<
		0.242697 << 0.981626 << 0.215642 <<
		0.230276 << 0.979556 << 0.226683 <<
		0.217856 << 0.977486 << 0.237723 <<
		0.205435 << 0.975416 << 0.248763 <<
		0.193015 << 0.973346 << 0.259804 <<
		0.180594 << 0.971276 << 0.270844 <<
		0.168174 << 0.969205 << 0.281885 <<
		0.155753 << 0.967135 << 0.292925 <<
		0.143333 << 0.965065 << 0.303966 <<
		0.130912 << 0.962995 << 0.315006 <<
		0.118492 << 0.960925 << 0.326047 <<
		0.106071 << 0.958855 << 0.337087 <<
		0.093651 << 0.956785 << 0.348128 <<
		0.081230 << 0.954715 << 0.359168 <<
		0.068810 << 0.952645 << 0.370208 <<
		0.056389 << 0.950575 << 0.381249 <<
		0.043969 << 0.948505 << 0.392289 <<
		0.031548 << 0.946434 << 0.403330 <<
		0.019128 << 0.944364 << 0.414370 <<
		0.006707 << 0.942294 << 0.425411 <<
		0.000000 << 0.931019 << 0.440578 <<
		0.000000 << 0.908938 << 0.460588 <<
		0.000000 << 0.886857 << 0.480599 <<
		0.000000 << 0.864777 << 0.500610 <<
		0.000000 << 0.842696 << 0.520621 <<
		0.000000 << 0.820615 << 0.540632 <<
		0.000000 << 0.798534 << 0.560642 <<
		0.000000 << 0.776453 << 0.580653 <<
		0.000000 << 0.754372 << 0.600664 <<
		0.000000 << 0.732291 << 0.620675 <<
		0.000000 << 0.710210 << 0.640686 <<
		0.000000 << 0.688129 << 0.660697 <<
		0.000000 << 0.666048 << 0.680707 <<
		0.000000 << 0.643967 << 0.700718 <<
		0.000000 << 0.621887 << 0.720729 <<
		0.000000 << 0.599806 << 0.740740 <<
		0.000000 << 0.577725 << 0.760751 <<
		0.000000 << 0.555644 << 0.780761 <<
		0.000000 << 0.533563 << 0.800772 <<
		0.000000 << 0.511482 << 0.820783 <<
		0.000000 << 0.489401 << 0.840794 <<
		0.000000 << 0.467320 << 0.860805 <<
		0.000000 << 0.445239 << 0.880816 <<
		0.000000 << 0.423158 << 0.900826 <<
		0.000000 << 0.401078 << 0.920837 <<
		0.000000 << 0.378997 << 0.940848 <<
		0.000000 << 0.356916 << 0.960859 <<
		0.000000 << 0.334835 << 0.980870 <<
		0.000000 << 0.313242 << 0.999698 <<
		0.000000 << 0.302251 << 0.992828 <<
		0.000000 << 0.291260 << 0.985959 <<
		0.000000 << 0.280269 << 0.979090 <<
		0.000000 << 0.269278 << 0.972220 <<
		0.000000 << 0.258287 << 0.965351 <<
		0.000000 << 0.247296 << 0.958482 <<
		0.000000 << 0.236305 << 0.951612 <<
		0.000000 << 0.225314 << 0.944743 <<
		0.000000 << 0.214323 << 0.937874 <<
		0.000000 << 0.203332 << 0.931004 <<
		0.000000 << 0.192342 << 0.924135 <<
		0.000000 << 0.181351 << 0.917266 <<
		0.000000 << 0.170360 << 0.910396 <<
		0.000000 << 0.159369 << 0.903527 <<
		0.000000 << 0.148378 << 0.896658 <<
		0.000000 << 0.137387 << 0.889788 <<
		0.000000 << 0.126396 << 0.882919 <<
		0.000000 << 0.115405 << 0.876050 <<
		0.000000 << 0.104414 << 0.869180 <<
		0.000000 << 0.093423 << 0.862311 <<
		0.000000 << 0.082432 << 0.855442 <<
		0.000000 << 0.071441 << 0.848572 <<
		0.000000 << 0.060450 << 0.841703 <<
		0.000000 << 0.049459 << 0.834834 <<
		0.000000 << 0.038468 << 0.827964 <<
		0.000000 << 0.027477 << 0.821095 <<
		0.000000 << 0.016486 << 0.814226 << 0.000000 << 0.005495 << 0.807356;

	QVector< QColor > result;
	for (int i = 0; i < colorArray.size();){
		QColor color(255 * colorArray[i], 255 * colorArray[i + 1], 255 * colorArray[i + 2]);
		i += 3;
		result.push_back(color);
	}
	return result;
}

static inline QColor getColorFromMap(double v, const QVector< QColor > & cmap){
	int idx = int (v * (cmap.size()-1)) % cmap.size();
	return cmap[idx];
}
